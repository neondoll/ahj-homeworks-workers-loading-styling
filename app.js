(()=>{"use strict";const t="MISSING_ENV_VAR".API_ROOT||"https://ahj-homeworks-workers-loading-styling-03f3.onrender.com";class e{constructor(){this._body=void 0,this._container=void 0,this._element=void 0,this.updateItems=this.updateItems.bind(this)}bindToDOM(t){if(!(t instanceof HTMLElement))throw new Error("container is not HTMLElement");this._container=t}checkBinding(){if(void 0===this._container)throw new Error("Widget not bind to DOM")}drawUI(){this.checkBinding(),this._container.innerHTML=e.markup,this._element=this._container.querySelector(e.selector),this._body=this._element.querySelector(e.selectorBody),this.updateItems(),this._element.querySelector(e.selectorBtnUpdate).addEventListener("click",this.updateItems)}async updateItems(){this._body.innerHTML=Array.from({length:3}).map((()=>e.markupItemLoading)).join("");try{const t=await e.api,i=await t.json();this._body.innerHTML=i.map((t=>e.markupItem(t))).join("")}catch(t){console.log(t),this._element.classList.add("widget--invalid")}}static get api(){return fetch(t+"/api/cinema-world-news",{method:"GET"})}static get markup(){return'\n      <section class="widget">\n        <div class="widget__header">\n          <h2 class="widget__title">Новости мира кино</h2>\n          <button class="widget__btn-update" type="button">Обновить</button>\n        </div>\n        <div class="widget__body"></div>\n      </section>\n    '}static markupItem(t){return`\n      <article class="widget__item widget-item" data-id="${t.id}">\n        <h3 class="widget-item__title">${t.title}</h3>\n        <div class="widget-item__description">\n          <img class="widget-item__image" src="${t.image}" alt="${t.image}">\n          <p class="widget-item__text">${t.text}</p>\n        </div>\n      </article>\n    `}static get markupItemLoading(){return'\n      <div class="widget__item widget-item widget-item--loading">\n        <span class="widget-item__title widget-item__title--loading"></span>\n        <div class="widget-item__description widget-item__description--loading">\n          <span class="widget-item__image widget-item__image--loading"></span>\n          <span class="widget-item__text widget-item__text--loading"></span>\n        </div>\n      </div>\n    '}static get selector(){return".widget"}static get selectorBody(){return".widget__body"}static get selectorBtnUpdate(){return".widget__btn-update"}}document.addEventListener("DOMContentLoaded",(()=>{console.log("API_ROOT",t),(async()=>{if("serviceWorker"in navigator)try{const t=await navigator.serviceWorker.register("./service.worker.js");console.log(`Registration succeeded. Scope is ${t.scope}`)}catch(t){console.error(`Registration failed with ${t}`)}})();const i=document.querySelector("#app"),n=new e;n.bindToDOM(i),n.drawUI()}))})();